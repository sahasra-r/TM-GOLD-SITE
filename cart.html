<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Your Cart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="cart-container">
    <h1>Your Cart</h1>

    <!-- ‚úÖ Add missing cart container -->
    <div id="cart-items"></div>

    <!-- ‚úÖ Add More Products button -->
    <div class="cart-actions">
      <a href="products.html" class="more-products-btn">‚ûï Add More Products</a>
    </div>

    <!-- ‚úÖ WhatsApp sticky footer -->
    <div class="whatsapp-footer">
      <button id="whatsapp-button" onclick="sendOrderToWhatsApp()">Send Order on WhatsApp</button>
    </div>
  </main>

  <script>
    const sizes = [
      "40g - ‚Çπ23",
      "100g - ‚Çπ55",
      "200g - ‚Çπ108",
      "250g - ‚Çπ122",
      "500g - ‚Çπ225",
      "1000g - ‚Çπ415"
    ];

    function renderCart() {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      const container = document.getElementById("cart-items");
      container.innerHTML = "";

      if (cart.length === 0) {
        container.innerHTML = `<p style="text-align:center; font-size: 18px; margin: 2rem 0;">üõçÔ∏è Your cart is empty. <br><a href='products.html' style='color:#007bff;'>Add products to shop</a></p>`;
        return;
      }

      cart.forEach((item, index) => {
        const itemDiv = document.createElement("div");
        itemDiv.className = "cart-item";

        const sizeOptions = sizes.map(size => 
          `<option value="${size}" ${item.size.trim() === size.trim() ? 'selected' : ''}>${size}</option>`).join("");

        itemDiv.innerHTML = `
          <img src="${item.image}" alt="${item.name}" class="cart-thumb">
          <div class="cart-text">
            <h3>${item.name || "Unnamed Product"}</h3>
            <label for="size-${index}">Size:</label>
            <select id="size-${index}" onchange="updateSize(${index}, this.value)">
              ${sizeOptions}
            </select>

            <div class="quantity-controls">
              <button onclick="updateQuantity(${index}, -1)">‚àí</button>
              <input type="text" value="${item.quantity}" readonly>
              <button onclick="updateQuantity(${index}, 1)">+</button>
            </div>
          </div>
          <button onclick="removeCartItem(${index})" class="remove-btn">remove</button>
        `;

        container.appendChild(itemDiv);
      });
    }

    function updateQuantity(index, amount) {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      let qty = parseInt(cart[index].quantity) || 1;
      qty += amount;
      if (qty < 1) qty = 1;
      cart[index].quantity = qty;
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }

    function updateSize(index, newSize) {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      cart[index].size = newSize.trim();
      localStorage.setItem("cart", JSON.stringify(cart));
    }

    function removeCartItem(index) {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }

    function sendOrderToWhatsApp() {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      if (cart.length === 0) return alert("Your cart is empty!");

      let message = "üõí *TM Gold Products Order Summary*:\n\n";
      cart.forEach((item, i) => {
        message += `${i + 1}. *${item.name || "Product"}*\nSize: ${item.size}, Qty: ${item.quantity}\n\n`;
      });

      const encodedMessage = encodeURIComponent(message);
      window.open(`https://wa.me/917396315801?text=${encodedMessage}`, "_blank");
    }

    renderCart();
  </script>
  <script>
  function loadCart() {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    let container = document.getElementById("cart-container");

    if (cart.length === 0) {
      container.innerHTML = "<p class='empty-msg'>Your cart is empty üõí</p>";
      return;
    }

    container.innerHTML = ""; // Clear previous

    cart.forEach((item, index) => {
      container.innerHTML += `
        <div class="cart-item-card">
          <p><b>${item.name}</b> | Size: ${item.size} | Qty: ${item.quantity}</p>
          <button onclick="removeFromCart(${index})">‚ùå Remove</button>
        </div>
      `;
    });
  }

  function removeFromCart(index) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    cart.splice(index, 1);
    localStorage.setItem("cart", JSON.stringify(cart));
    loadCart();
  }

  window.onload = loadCart;
</script>

</body>
</html>
